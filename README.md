# shubich-vo-imja-zhizni
Автобиографическая повесть Шубича М.П.

# Пояснения к исходному коду
## Условные обозначения
### Дефисы, тире

|Условный Знак|Пояснение			|Пакет	|Рекомендация|
|:-----:|-------------------|:-----:|:----------:|
|`…`	|**Многоточие**	|-	|Да|
|`-`	|**Разрывный** дефис, без переноса составных слов|-|-|
|`\-/`	|**Разрывный** дефис, с переносом составных слов|[extdash](https://ctan.org/pkg/extdash)|Да|
|`"=`	|**Разрывный** дефис, с переносом составных слов|[babel](https://ctan.org/pkg/babel-russian)|-|
|`\=/`	|**Неразрывный** дефис, c переносом составных слов|extdash|Да|
|`"~`	|**Неразрывный** дефис, без переноса составных слов|babel|-|
|`\-`	|**Указывает**, что ТОЛЬКО в этих местах + по дефису возможен перенос слова|-|-|
|`"-`	|**Указывает**, что ДОПОЛНИТЕЛЬНО в этих местах возможен перенос слова. Также с этого места прекращается действие "~|babel|-|
|`""`	|**Аналог** "- , но в месте переноса не ставится дефис|babel|-|
|`–`		|**Короткое** неразрывное тире, без переноса составных слов|-|-|
|`\--`	|**Короткое** разрывное тире, с переносом составных слов|extdash|Да|
|`\==`	|**Короткое** неразрывное тире, с переносом составных слов|extdash|Да|
|`"--~`	|**Длинное** разрывное тире, с переносом составных слов (для двойных фамилий, съедает пробелы)|babel|Нет. Используй короткое|
|`—`	|**Длинное** тире в тексте||Нет|
|`"--* ˽`|**Длинное** тире, нерастяжимый пробел (прямая речь) (Внимание: ˽ означает наличие пробела)|babel|Да|
|`˽ "--- ˽`|**Неразбиваемый** нерастяжимый узкий пробел, длинное разрывное тире, разбиваемый нерастяжимый узкий пробел (Внимание: ˽ означает наличие пробела)|babel|Да|
|`˽ \--- ˽`|**Неразбиваемый** нерастяжимый  пробел, длинное разрывное тире, разбиваемый нерастяжимый  пробел (Внимание: ˽ означает наличие пробела)|extdash|Нет, в pdf вставляет короткое тире|
|`˽ \=== ˽`|**Неразбиваемый** нерастяжимый  пробел, длинное тире, НЕразбиваемый нерастяжимый пробел (Внимание: ˽ означает наличие пробела)|extdash|Нет, в pdf вставляет короткое тире|



### Другие символы
|Обозначение|Символ Unicode|Пояснение|
|:---------:|:------------:|---------|
|`<<`		|«|Открывающая левая кавычка «ёлочка»|
|`>>`		|»|Закрывающая правая кавычка «ёлочка»|
|`,,`		|„|Нижняя двойная открывающая кавычка|
|``			|“|Закрывающая двойная кавычка|
|`\%`		|%|Знак процента|
|` ˽`		| |Разрывный растяжимый пробел("˽" - пробел)|
|`\˽`		| |Разрывный нерастяжимый пробел("˽" - пробел)|
|`~`    	| |Неразрывный растяжимый пробел|
|`\,`	    | |Тонкий неразрывный пробел|
|`",`		| |Тонкий разрывный пробел|
|`˚`    	||Желательно неразрывный пробел|
 
## Выражения для поиска ошибок и коррекции ввода
Примечание: символы `{}` используются для выделения регулярного выражения
**NB!** Данные выражения слабо тестированы.
### I. Корректировка набора
1. Заменить 2 пробела подряд 1  
2. Заменить 3 перевода строки 2
3. Заменить три точки на многоточие:  
 Поиск: 	`{[.]{3}}`
 Замена:	`{…}`
3. Маленькая буква в прямой речи  
 Поиск:	`{(?-i)[„<"«][а-яё]}`
4. Правильное окончание прямой речи
 Поиск ошибки - точка и запятая перед кавычкой:	`{[.,][\>»]}` 
 Поиск ошибки - ?!… после кавычки:				`{[\>»][?!…]}`
 Поиск ошибки - автор после прямой речи (д.б. {",—}):`{[>»][,]\s*}`

5. Убрать слова "г." или "год" после дат в формате дд.мм.гггг 
 Поиск: 	`{(?m-i)(\d{1,2}.\d{1,2}.\d{2,4})\s*((года|год)(?=[^А-Яа-яЁёA-Za-z])|(г[.](?!\h*[А-ЯЁA-Z\v]))|(г(?=[\s.])))}`
 Замена:	`{$1}`

6. заменить слово "года" после дат в формате дд месяц гггг
 Поиск:		`{((января|февраля|марта|апреля|мая|июня|июля|августа|сентября|октября|ноября|декабря)\h\d{4}\h)года[.]*}` 
 Замена:	`{$1г.}`
 
 
### II. Корректировка ФИО
Правильный ввод `И.\,О.~Фамилия` или Имя Отчество Фамилия. При этом отчество может быть опущено

1. Поиск строк "Фамилия Имя Отчество":  
 `{(?m-i)(\W|^)([А-ЯЁA-Z][а-яёa-z–"~-]+)[\h,]+([А-ЯЁA-Z][а-яёa-z–"~-]+)[\h,]+([А-ЯЁA-Z][а-яёa-z–"~-]+)}`
 Замена: `{$1$3 $4 $2}`

2. Поиск строк "Фамилия Имя": `{(?m-i)(\W|^)([А-ЯЁA-Z][а-яёa-z–"~-]+)[\h,]+([А-ЯЁA-Z][а-яёa-z–"~-]+)}`
 Замена: `{$1$3 $2}`
 Поиск:`{(?-i)([А-ЯA-ZЁ]\.)\s*([А-ЯA-Z]\.)\s*}`
 Замена: `{$1\\,$2}`

3. Поиск строк Фамилия И.О.: `{(?m-i)(\W|^)([А-ЯЁA-Z][а-яёa-z–"~-]+)[\h,]+([А-ЯЁA-Z][–"~.-]{0,2}[А-ЯЁA-Z.]{0,2})[\h,]*([А-ЯЁA-Z][–"~.-]{0,2}[А-ЯЁA-Z.]{0,2})(\W)}`
 Замена: `{$1$3\\,$4~$2$5}`

4. Поиск строк Фамилия И.: `{(?m-i)(\W|^)([А-ЯЁA-Z][а-яёa-z–"~-]+)[\h,]+([А-ЯЁA-Z][–"~.-]{0,2}[А-ЯЁA-Z.]{0,2})(\W)}`
 Замена: `{$1$3~$2$4}`

5. Поиск строк И.О.Фамилия: `{(?m-i)(\W|^)([А-ЯЁA-Z][–"~.-]{0,2}[А-ЯЁA-Z.]{0,2})[\h,]*([А-ЯЁA-Z][–"~.-]{0,2}[А-ЯЁA-Z.]{0,2})[\h,]*([А-ЯЁA-Z][а-яёa-z–"~-]+)(\W)}`
 Замена: `{$1$2\\,$3~$4$5}`

6. Поиск строк И.Фамилия: `{(?m-i)(^|\h)([А-ЯЁA-Z]{1}[.]?)[\h,]*([А-ЯЁA-Z][а-яёa-z–"~-]+)(\W)*}`
 Замена: `{$1$2~$3$4}`

### III. Тире, дефис, многоточие
#### Дефис {‐} и неразрывный дефис {‑}. Общие замечания
Дефис только внутри слов. 
Разрешает перенос по дефису (пакет extdash):	`\-/`
Неразрешает перенос по дефису (пакет extdash):	`\=/`
Для себя решил, что предлоги из двух слогов с дефисом не переносить вообще, когда более двух слогов переность можно. При этом слова где дефис используется для связи двух слов можно переносить по дефису, а где нет - нельзя.

#### Тире
Тире короткое{–}: в диапазоне номеров, даже если словами; между фамилиями.
Разрешает перенос по тире (пакет extdash):		`\--`
Запрещает перенос по тире (пакет extdash):		`\==`

тире длинное {—}: во всех остальных случаях.
Разрешает перенос по тире(babel):		`"---`

1. Поиск дефиса внутри слова:	`{(?i)([а-яА-ЯёЁ]+)-([а-яА-ЯёЁ]+)}`
 Замена: 
 можно переносить по дефису "генерал`\-/`майор" (extdash)	`{$1\\-/$2}`
 нельзя переносить по дефису "кого`\=/`либо" (extdash)		`{$1\\=/$2}`
 два слога в слове "из-за"									{Ничего не делаем} ***- может нужен неразрывный дефис?***

2. Поиск слова в котором число стоит после дефиса и наоборот:
 `{(?i)([а-яА-ЯёЁ])-(\d)}`
 `{(?i)(\d)-([а-яА-ЯёЁa-zA-Z])}`
 Замена: 	`{$1\\=/$2}`


3. Поиск тире между цифрами (короткое тире)
 `{(\d)[ ]*-[ ]*(\d)}`
 Замена: 	
 можно переносить по тире 	`{$1\\--$2}`
 нельзя переносить по тире 	`{$1\\==$2}`

4. Поиск тире между словами (длинное тире)
 Отделён от следующего слова пробелами		`{(?<![-])[ ]*-[ ]+}`
 Отделён от предыдущего слова пробелами		`{[ ]+-[ ]*}`	
 Замена:
 можно переносить по тире 					`{ "--- }` (Пробелы нужны!)
 начало прямой речи							`{"--* }` (Пробел в конце нужен!)

#### Многоточие {…}
Многоточие после сокращения, заканчивающегося точкой, отбиваются неразрывным пробелом 
`Дисс.\,… канд. физ.мат`

  
### IV. Пробелы
Межсловынй неразрывный пробел U+00A0{ }
Межсловный пробел - стандартный пробел U+0020 { }
Тонкая шпация - примерно равен ширине 1/5*М U+2009{ }

#### А. Тонкая шпация (\,){ }
1. Число и соответствующая ему единица измерения (кроме знаков градуса, минуты и секунды) отбиваются тонкой шпацией
 400\,м
 100\,т
 451\,°F
 **но!** 59° или 57′ или 00″.
 **но!** смотри счётные слова ниже
 
 Поиск: `{(\d)[  ~]*(г.|гс|кг|ц|т|тс|л|Нп|Б|эВ|мм|см|м|км|га|а|сек.|мин|ч|сут|А|К|°|кд|бар|бит|Б|Мб)}`
 Замена: `{$1\\,$2}`

2. Знаки градуса, минуты и секунды отбиваются тонкой шпацией
 59°\,57′\,00″

3. Разряды числа отбиваются друг от друга тонкой шпацией, кроме дат, номеров (например, документов), обозначений машин и механизмов.
 25\,563,42
 1\,652
 1\,298\,300
 но 1999 год, ГОСТ 20283, вх. № 982364
 Поиск: `{(\d){4}}`

#### Б. Неразрывный пробел. Обязательно!
1. В сокращениях 
 и т. д. — и т. д.
 и т. п. — и т. п.
 т. к. — т. к.
 т. е. — т. е.
 и др. — и др.
 и пр. — и пр.
 до н. э. — до н. э.
 ю. ш. — ю. ш.

 Поиск для 3 слов {и т. д.}:
 `{(?-i)([  ][а-яёА-ЯЁ]{1,3})[  ]([а-яё]{1,3}[.])[ ]?([а-яё]{1,3}[.])}`
 Замена: 
 `{$1~$2~$3}`
 Поиск для 2 слов {т. к.}:
 `{(?-i)([а-яёА-ЯЁ]{1,3}[.])[  ]?([а-яё]{1,3}[.])}`
 Замена: 
 `{$1~$2}`


2. Сокращённое слово от имени собственного
 ул. Щорса
 г. Москва
 метрополитен им. Ленина
 Поиск:
 `{([\s](ул|ст|им|г|д|обл|с|пос|стр|гл|подп|пп|разд|ч|рис|табл|см|ср|тов|тел|напр)[.])[  ]*(?!~)}`
 Замена: `{$1~}`

3. После #№§
 Поиск: `{([#№§])([  ]*[\n\r]{0,4}[  ]*)(\d)}`
 Замена: `{$1~$3}`

4. Число и соответствующее ему счётное слово
 12 млрд рублей
 XX в
 1941—1945 гг.
 25 %
 Поиск: `{(?-i)(\d|[IVX](?= ))([  \n]*)([а-яa-z%]|\\%)}`
 Замена: `{$1~$3}`

5. Однобуквенные слова в начале предложения (+в скобках, кавычка):
 Поиск: `{(?-i)(\W)([А-ЯЁA-Z]|([(„<"«]|,,)[А-ЯЁа-яёA-Za-z])\s+}`
 Замена: `{$1$2~}`

6. Не отрывать "не" от глагола
 Поиск:`{([\W]не)\s([а-яА-ЯёЁ]{2}|[0-9]+)}`
 Замена: `{$1~$2}`

#### В. Неразрывный пробел. Желательный!
Идея заимствована на [habrahabr](https://habrahabr.ru/post/339110/)
В преамбулу надо добавить
```latex
\usepackage{newunicodechar}
\newcount\afterconjunctionpenalty
\afterconjunctionpenalty=1000
\newunicodechar{˚}{\penalty\afterconjunctionpenalty\ }
```

1. Многобуквенные союзы и предлоги в начале предложения хорошо бы не отрывать:
 Поиск:`{(?-i)(\W)(Абы|Аж|Ай|Аки|Ако|Али|Аль|Ан|Аще|Без|Безо|Благо|Благодаря|Близ|Близко|Бо|Буде|Будто|Вблизи|Ввиду|Вглубь|Вдогон|Вдоль|Ведь|Взамен|Включая|Вкруг|Вместо|Вне|Внизу|Внутри|Внутрь|Во|Вовнутрь|Возле|Вокруг|Вопреки|Вослед|Впереди|Вплоть|Впредь|Впрочем|Вразрез|Вроде|Вслед|Вследствие|Всё|Где|Да|Дабы|Даже|Для|До|Докуда|Дотоле|Егда|Едва|Еже|Ежели|Если|Же|За|Заместо|Зане|Занеже|Зато|Зачем|Значит|Ибо|Из|Изнутри|Изо|Или|Иль|Именно|Имже|Иначе|Инда|Исключая|Исходя|Итак|Кабы|Как|Каков|Какой|Касательно|Ко|Когда|Когды|Коли|Коль|Который|Кроме|Кругом|Куда|Ли|Либо|Лицом|Лишь|Ль|Меж|Между|Мимо|На|Наверху|Навроде|Навстречу|Над|Надо|Назад|Назади|Накануне|Наместо|Наперекор|Наперерез|Наподобие|Напротив|Наряду|Настолько|Насупротив|Насчёт|Начиная|Не|Невзирая|Недалеко|Нежели|Независимо|Несмотря|Ни|Ниже|Но|Об|Обаче|Обо|Обок|Однако|Около|Окрест|Окромя|Округ|Опосля|Опричь|От|Отколь|Откуда|Откудова|Относительно|Ото|Оттого|Отчего|Перед|Передо|По|Поблизости|Поверх|Под|Подле|Подо|Подобно|Поелику|Позади|Позднее|Пока|Покамест|Покаместь|Покеда|Помимо|Понеже|Поперёд|Поперёк|Порядка|Посверху|Посередине|Посередь|Поскольку|После|Посреди|Посредине|Посредством|Пота|Потому|Почему|Почём|Правда|Пред|Предо|Прежде|При|Применительно|Притом|Причём|Про|Промеж|Просто|Против|Противу|Пускай|Пусть|Равно|Ради|Раз|Разве|Ровно|Рядом|Сверх|Сверху|Свыше|Середи|Сзади|Сиречь|Сколько|Следовательно|Следом|Словно|Смотря|Снизу|Со|Согласно|Спустя|Среди|Средь|Сродни|Столько|Судя|Супротив|Так|Также|Теперь|То|Тож|Тоже|Только|Хоть|Хотя|Чем|Через|Черезо|Чрез|Что|Чтоб|Чтобы|Чуть|Яко|Якобы)(?=[,:;]*)\s+}`
 Замена: `{$1$2˚}`

2. Одно- двухбуквенные союзы и предлоги внутри текста хорошо бы не отрывать от многобуквенных слов (какие-то прилепляя к следующему слову, какие-то — к предыдущему):

 Поиск:`{\s+([бжБЖ]\s)}`
 Замена: `{˚$1}`
 
 Поиск:`{(?-i)([^\w\/=˚-][а-яё]{1,2})\s(?=[а-яА-ЯёЁ]{3}|[0-9]+)}`
 Замена: `{$1˚}`
 
 # Вспомогательные регулярные выражения
 
 1. Поиск где автор использует личные местоимения:`{[ ˚~\\,.!?,«](я|мне|меня|мы|мной|мною|нас|нам|нами|нас|моей|моему|мой)[ ˚~\\,.!?,»…]}`